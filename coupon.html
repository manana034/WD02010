<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="./coupon.css" rel="stylesheet">

</head>
<body>

    <div class="dice-wrap">
        <ul id="dice">
          <li class="dice-1"><a href="coursecontent.html"><img src="./img/dice1.png"><h4>藍色夏威夷</h4></a></li>
          <li class="dice-2"><a href="coursecontent.html"><img src="./img/dice2.png"><h4>蔓越莓瑪格麗特</h4></a></li>
          <li class="dice-3"><a href="coursecontent.html"><img src="./img/dice3.png"><h4>接骨木魔杖</h4></a></li>
          <li class="dice-4"><a href="coursecontent.html"><img src="./img/dice4.png"><h4>龍舌蘭日出</h4></a></li>
          <li class="dice-5"><a href="coursecontent.html"><img src="./img/dice5.png"><h4>黑醋栗烏龍</h4></a></li>
          <li class="dice-6"><a href="coursecontent.html"><img src="./img/dice6.png"><h4>大華的眼淚<br>**牛年限定**</h4></a></li>
        </ul>
    </div>
    <div class="action">
        <p>點擊骰子可以看相關課程喔</p>
        <span class="btn" id="btn-start">Start</span>
    </div>
      
    <div class="result">
        <div><p id="dice-count"></p></div>
    </div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>

(function(window, document, Math, undefined){
  function $(selector){
    return document.querySelector(selector);
  }
  function addClass(ele, className){
    ele.setAttribute('class', ele.getAttribute('class') ? ele.getAttribute('class').replace(/^.*\w+.*$/, ' ' + className) : className);
  }
  function removeClass(ele, className){
    ele.getAttribute('class') && ele.setAttribute('class', ele.getAttribute('class').replace(new RegExp(' ' + className, 'g'), ''));
  }

  var $dice = $('#dice');
  var $diceResult = $('#dice-count');
  var dots = ['dice1', 'dice2', 'dice3', 'dice4', 'dice5', 'dice6'];

  $('#btn-start').addEventListener('click', function(){
    $diceResult.innerHTML = '';
    addClass($dice, 'shuffling'); // start
    var countDown = Math.floor(Math.random() * 6) + 5;
    var dot = Math.floor(Math.random() * 6) % 6 + 1;
    var timer = setInterval(function(){
      if (countDown <= 0) {
        clearInterval(timer);
        setTimeout(function(){
          setDots(dot - 1);
          removeClass($dice, 'shuffling'); // end

        //   $diceResult.innerHTML = dot;
        // let add = `<div class="XX">
        //             <p>骰到${dot}點</p>
        //             <img src="./img/dice${dot}.png">
        //             </div>`
        let sale = Math.round(100-dot*100/16)/10;
        if(dot == 1 ){
            // $('#dice-count').append(add);
            $diceResult.innerHTML = `<div class="sale">想不到吧 還有<b>銘謝惠顧</b><br>
                                    運氣不好沒關係，你可以多骰幾次</div>`;
        }else if(dot == 6){
            $diceResult.innerHTML = `<div class="sale">折扣代碼 <b>sale${dot}00<br>
                                    天選之人！牛年你一定會過得很好</b>(大華是一隻牛)<br>
                                    恭喜你得到滿1000元折${dot}00元的優惠券，最高可享${sale}折<br>
                                    <a href="course.html">快點去選購課程吧</a></div>`;
        }else{
            $diceResult.innerHTML = `<div class="sale">折扣代碼 <b>sale${dot}00</b><br>
                                    恭喜你得到滿1500元折${dot}00元的優惠券，最高可享${sale}折<br>
                                    <a href="course.html">快點去選購課程吧</a><div>`;
        };
        }, 1000);
      }
      countDown--;
    }, 100);
    $('#btn-start').innerText="Play again";
  });
  
  function setDots(dot){
    addClass($dice, dots[dot]);
  }
})(window, document, Math);

      </script>
</body>
</html>